repl = do (
  x <- readInt <>
  _ <- writeInt x
  y <- readInt <>
  _ <- writeInt y
  _ <- writeInt (add x y !)
  rec <- repl
  rec
)

repl
